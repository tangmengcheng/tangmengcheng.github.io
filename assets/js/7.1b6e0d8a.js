(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{204:function(t,s,a){t.exports=a.p+"assets/img/intersectionObserver.7c6b44b7.jpg"},205:function(t,s,a){t.exports=a.p+"assets/img/resizeObserver.2c9ea6a4.jpg"},321:function(t,s,a){"use strict";a.r(s);var e=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("p",[t._v("比如 "),e("code",[t._v("元素从不可见到可见")]),t._v("、"),e("code",[t._v("元素大小的改变")]),t._v("、"),e("code",[t._v("元素的属性和子节点的修改")]),t._v("等等，这类事件的监听，浏览器提供了 5 种 "),e("code",[t._v("Observer")]),t._v(" 来监听这些变动："),e("code",[t._v("MutationObserver")]),t._v("、"),e("code",[t._v("IntersectionObserver")]),t._v("、"),e("code",[t._v("PerformanceObserver")]),t._v("、"),e("code",[t._v("ResizeObserver")]),t._v("、"),e("code",[t._v("ReportingObserver")])]),t._v(" "),e("h2",{attrs:{id:"intersectionobserver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#intersectionobserver","aria-hidden":"true"}},[t._v("#")]),t._v(" IntersectionObserver")]),t._v(" "),e("p",[t._v("它可以监听一个元素和可视区域相交部分的比例，然后在可视比例达到某个阈值的时候触发回调。")]),t._v(" "),e("h3",{attrs:{id:"用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用法","aria-hidden":"true"}},[t._v("#")]),t._v(" 用法")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  rootMargin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  thresholds"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" io "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entries")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entries"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TODO...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("接收两个参数 "),e("code",[t._v("callback")]),t._v(" 和 "),e("code",[t._v("options")]),t._v("，回调函数中参数 "),e("code",[t._v("entries")]),t._v(" 是 "),e("code",[t._v("IntersectionObserverEntry")]),t._v(" 实例。描述了 "),e("code",[t._v("目标元素")]),t._v(" 与 "),e("code",[t._v("root")]),t._v(" 的交叉状态。")]),t._v(" "),e("h3",{attrs:{id:"回调函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#回调函数","aria-hidden":"true"}},[t._v("#")]),t._v(" 回调函数")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("属性")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("boundingClientRect")]),t._v(" "),e("td",[t._v("返回包含目标元素的边界信息，返回结果与 element.getBoundingClientRect() 相同")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("intersectionRatio")])]),t._v(" "),e("td",[t._v("返回目标元素出现在可视区的比例")])]),t._v(" "),e("tr",[e("td",[t._v("intersectionRect")]),t._v(" "),e("td",[t._v("用来描述 root 和目标元素的相交区域")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("isIntersecting")])]),t._v(" "),e("td",[t._v("返回一个布尔值。1. 如果目标元素出现在 root 可视区，返回 true。2. 如果从 root 可视区消失，返回 false")])]),t._v(" "),e("tr",[e("td",[t._v("rootBounds")]),t._v(" "),e("td",[t._v("用来描述交叉区域观察者(intersection observer)中的根.")])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("target")])]),t._v(" "),e("td",[t._v("目标元素：与根出现相交区域改变的元素 (Element)")])]),t._v(" "),e("tr",[e("td",[t._v("time")]),t._v(" "),e("td",[t._v("返回一个记录从 IntersectionObserver 的时间原点到交叉被触发的时间的时间戳")])])])]),t._v(" "),e("p",[e("strong",[t._v("注意")]),t._v("：表格中加粗的属性是比较常用的判断条件")]),t._v(" "),e("p",[e("img",{attrs:{src:a(204),alt:""}})]),t._v(" "),e("h3",{attrs:{id:"options-选项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#options-选项","aria-hidden":"true"}},[t._v("#")]),t._v(" options 选项")]),t._v(" "),e("p",[t._v("options 是一个对象，可选参数：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("属性")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("root")]),t._v(" "),e("td",[t._v("所监听对象的具体祖先元素。如果未传入值或值为 null，则默认使用顶级文档的视窗(一般为 html)")])]),t._v(" "),e("tr",[e("td",[t._v("rootMargin")]),t._v(" "),e("td",[t._v('计算交叉时添加到根(root)边界盒 bounding box 的矩形偏移量， 可以有效的缩小或扩大根的判定范围从而满足计算需要。所有的偏移量均可用像素(px)或百分比(%)来表达, 默认值为"0px 0px 0px 0px"')])]),t._v(" "),e("tr",[e("td",[t._v("threshold")]),t._v(" "),e("td",[t._v("一个包含阈值的列表, 按升序排列, 列表中的每个阈值都是监听对象的交叉区域与边界区域的比率。当监听对象的任何阈值被越过时，都会触发 callback。默认值为 0")])])])]),t._v(" "),e("h3",{attrs:{id:"实例方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实例方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 实例方法")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("属性")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("observe()")]),t._v(" "),e("td",[t._v("开始监听一个目标元素")])]),t._v(" "),e("tr",[e("td",[t._v("unobserve()")]),t._v(" "),e("td",[t._v("停止监听特定目标元素")])]),t._v(" "),e("tr",[e("td",[t._v("takeRecords()")]),t._v(" "),e("td",[t._v("返回所有观察目标的 IntersectionObserverEntry 对象数组")])]),t._v(" "),e("tr",[e("td",[t._v("disconnect()")]),t._v(" "),e("td",[t._v("使 IntersectionObserver 对象停止全部监听工作")])])])]),t._v(" "),e("h3",{attrs:{id:"应用场景："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#应用场景：","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用场景：")]),t._v(" "),e("ol",[e("li",[t._v("图片懒加载")]),t._v(" "),e("li",[t._v("埋点曝光")]),t._v(" "),e("li",[t._v("滚动动画")])]),t._v(" "),e("h2",{attrs:{id:"mutationobserver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mutationobserver","aria-hidden":"true"}},[t._v("#")]),t._v(" MutationObserver")]),t._v(" "),e("p",[t._v("它可以监听对元素的属性的修改、对它的子节点的增删改")]),t._v(" "),e("h3",{attrs:{id:"用法-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用法-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 用法")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" observer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MutationObserver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *观察者回调\n *records:变化记录数组\n *instance:观察者对象本身\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("callback")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("records"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" instance")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("records"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("instance"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  records"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("record")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mutation Type: '")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" record"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mutation Change Attribute: '")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" record"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attributeName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Previous attribute value: '")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" record"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("oldValue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nobserver "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MutationObserver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("code",[t._v("callback")]),t._v("，即回调函数接收两个参数，第一个参数是一个包含了所有 "),e("code",[t._v("MutationRecord")]),t._v(" 对象的数组，第二个参数则是这个 "),e("code",[t._v("MutationObserver")]),t._v(" 实例本身。")]),t._v(" "),e("h3",{attrs:{id:"mutation-事件列表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mutation-事件列表","aria-hidden":"true"}},[t._v("#")]),t._v(" Mutation 事件列表")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("名称")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("DOMAttrModified")]),t._v(" "),e("td",[t._v("节点属性变更")])]),t._v(" "),e("tr",[e("td",[t._v("DOMAttributeNameChanged")]),t._v(" "),e("td",[t._v("节点属性属性节点名字改变")])]),t._v(" "),e("tr",[e("td",[t._v("DOMCharacterDataModified")]),t._v(" "),e("td",[t._v("节点中的文本节点改变")])]),t._v(" "),e("tr",[e("td",[t._v("DOMElementNameChanged")]),t._v(" "),e("td",[t._v("节点移除")])]),t._v(" "),e("tr",[e("td",[t._v("DOMNodeInserted")]),t._v(" "),e("td",[t._v("节点子节点插入")])]),t._v(" "),e("tr",[e("td",[t._v("DOMNodeRemoved")]),t._v(" "),e("td",[t._v("节点子节点移除")])]),t._v(" "),e("tr",[e("td",[t._v("DOMNodeInsertedIntoDocument")]),t._v(" "),e("td",[t._v("节点插入文档")])]),t._v(" "),e("tr",[e("td",[t._v("DOMSubtreeModified")]),t._v(" "),e("td",[t._v("节点子节点修改")])])])]),t._v(" "),e("h3",{attrs:{id:"观察者-observe"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#观察者-observe","aria-hidden":"true"}},[t._v("#")]),t._v(" 观察者 observe")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//观察者配置项")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" options "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  childList"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//观察目标节点的子节点的新增和删除")]),t._v("\n  subtree"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//观察目标节点的所有后代节点")]),t._v("\n  attributes"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//观察目标节点的属性节点")]),t._v("\n  attributeOldValue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在attributes属性已经设为true的前提下, 将发生变化的属性节点之前的属性值记录下来")]),t._v("\n  attributeFilter"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//一个属性名数组(不需要指定命名空间),只有该数组中包含的属性名发生变化时才会被观察到,其他名称的属性发生变化后会被忽略想要设置那些删选参数的话")]),t._v("\n  characterData"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果目标节点为characterData节点(一种抽象接口,具体可以为文本节点,注释节点,以及处理指令节点)时,也要观察该节点的文本内容是否发生变化")]),t._v("\n  characterDataOldValue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在characterData属性已经设为true的前提下,将发生变化characterData节点之前的文本内容记录下来(记录到下面MutationRecord对象的oldValue属性中)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//待观察的DOM节点")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" element "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//执行观察")]),t._v("\nobserver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"实例方法-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实例方法-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 实例方法")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("名称")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("disconnect()")]),t._v(" "),e("td",[t._v("停止观察")])]),t._v(" "),e("tr",[e("td",[t._v("takeRecords()")]),t._v(" "),e("td",[t._v("清除变动记录")])])])]),t._v(" "),e("h3",{attrs:{id:"应用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#应用场景","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用场景")]),t._v(" "),e("ol",[e("li",[e("code",[t._v("Vue 源码")]),t._v("里尝试使用 "),e("code",[t._v("mutationObserver")]),t._v(" 来做降级")])]),t._v(" "),e("h2",{attrs:{id:"performanceobserver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserver","aria-hidden":"true"}},[t._v("#")]),t._v(" PerformanceObserver")]),t._v(" "),e("h2",{attrs:{id:"resizeobserver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resizeobserver","aria-hidden":"true"}},[t._v("#")]),t._v(" ResizeObserver")]),t._v(" "),e("p",[e("strong",[t._v("问题")]),t._v("：窗口我们可以用 "),e("code",[t._v("addEventListener")]),t._v(" 监听 "),e("code",[t._v("resize")]),t._v(" 事件，那元素呢？")]),t._v(" "),e("p",[t._v("元素可以用 "),e("code",[t._v("ResizeObserver")]),t._v(" 监听大小的改变，当 "),e("code",[t._v("width")]),t._v("、"),e("code",[t._v("height")]),t._v(" 被修改时会触发回调。也可以做 "),e("code",[t._v("echarts")]),t._v(" 图表自适应")]),t._v(" "),e("h3",{attrs:{id:"用法-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用法-3","aria-hidden":"true"}},[t._v("#")]),t._v(" 用法")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" box "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#box'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  box"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("width "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'200px'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" resizeObserver "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResizeObserver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entries")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'当前大小'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" entries"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nresizeObserver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("box"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("img",{attrs:{src:a(205),alt:""}})]),t._v(" "),e("p",[t._v("可以拿到元素和它的位置、尺寸。这样我们就实现了对元素的 "),e("code",[t._v("resize")]),t._v(" 的监听。")]),t._v(" "),e("h2",{attrs:{id:"reportingobserver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#reportingobserver","aria-hidden":"true"}},[t._v("#")]),t._v(" ReportingObserver")])])}],n=a(0),r=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},e,!1,null,null,null);s.default=r.exports}}]);